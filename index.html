<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HOI4 Equipment Name Generator</title>
  <style>
    :root { color-scheme: dark; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:#0b0d10; color:#e8eef5; }
    .wrap { min-height:100vh; display:grid; place-items:center; padding:24px; }
    .card { width:min(1180px,100%); background:#121720; border:1px solid #1c2634; border-radius:18px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,.35); }
    h1 { margin:0 0 8px; font-size:18px; }
    p { margin:0 0 16px; font-size:13px; opacity:.8; line-height:1.4; }
    .grid { display:grid; grid-template-columns: 1.6fr 1fr 1fr 1fr auto; gap:12px; align-items:end; }
    label { display:block; font-size:12px; opacity:.8; margin-bottom:6px; }
    input, select {
      width:100%; background:#0f141c; border:1px solid #1c2634; color:#e8eef5;
      border-radius:12px; padding:10px 12px; font-size:14px; outline:none;
    }
    button { background:#2b7cff; color:white; border:0; padding:10px 14px; border-radius:12px; font-weight:800; cursor:pointer; white-space:nowrap; }
    button:hover { filter:brightness(1.05); }
    button:disabled { opacity:.5; cursor:not-allowed; }
    .out { margin-top:16px; padding:14px; border-radius:14px; border:1px solid #1c2634; background:#0f141c; }
    .name { font-size:20px; font-weight:900; letter-spacing:.2px; }
    .meta { margin-top:6px; font-size:12px; opacity:.8; }
    .row { display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; }
    .pill { font-size:12px; opacity:.85; padding:6px 10px; border:1px solid #1c2634; border-radius:999px; background:#0b0d10; }
    .tools { display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; align-items:center; }
    .ghost { background:transparent; border:1px solid #1c2634; color:#e8eef5; }
    .hint { margin-top:8px; font-size:12px; opacity:.65; }
    .warn { margin-top:10px; font-size:12px; opacity:.85; }

    /* Searchable dropdown */
    .picker { position: relative; }
    .dropdown {
      position:absolute; top: calc(100% + 6px); left:0; right:0;
      background:#0f141c; border:1px solid #1c2634; border-radius:14px;
      max-height: 280px; overflow:auto; z-index: 50;
      display:none;
    }
    .dropdown.open { display:block; }
    .item {
      padding:10px 12px; cursor:pointer; display:flex; justify-content:space-between; gap:10px;
      border-bottom:1px solid #162031;
    }
    .item:last-child { border-bottom:0; }
    .item:hover { background:#0b0d10; }
    .tag { font-weight:900; letter-spacing:.4px; }
    .country { opacity:.8; font-size:12px; }
    .small { font-size:12px; opacity:.7; }

    @media (max-width: 1040px){ .grid{ grid-template-columns:1fr; } button{ width:100%; } }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>HOI4 Equipment Name Generator</h1>
      <p>Search a country tag, pick category + year, toggle <b>Strict</b> vs <b>Flavor</b>, generate <b>unique</b> names using country-accurate formatting (not real historical equipment names).</p>

      <div class="grid">
        <div class="picker">
          <label for="countrySearch">Country tag (searchable)</label>
          <input id="countrySearch" placeholder="Type: GER, USA, SOV, ENG… (or any custom tag)" autocomplete="off" />
          <div class="dropdown" id="dropdown" role="listbox" aria-label="Country tags"></div>
          <div class="hint">
            Tip: Click a result to lock it in. Or type any 3-letter tag (mods) and hit Generate.
            Current selection: <span id="selTag" class="tag">GER</span> <span id="selName" class="small">(Germany)</span>
          </div>
        </div>

        <div>
          <label for="category">Category</label>
          <select id="category"></select>
        </div>

        <div>
          <label for="subtype">Role / Hull</label>
          <select id="subtype"></select>
        </div>

        <div>
          <label for="year">Year</label>
          <input id="year" type="number" min="1900" max="2100" value="1941" />
        </div>

        <div>
          <button id="gen" type="button">Generate</button>
        </div>
      </div>

      <div class="tools">
        <div style="min-width:260px;">
          <label for="mode">Naming mode</label>
          <select id="mode">
            <option value="strict" selected>Strict (designation format, unique)</option>
            <option value="flavor">Flavor (designation + codename)</option>
          </select>
        </div>
        <button id="copy" type="button" class="ghost">Copy name</button>
        <button id="reroll" type="button" class="ghost">Reroll</button>
      </div>

      <div class="out" aria-live="polite">
        <div class="name" id="name">—</div>
        <div class="meta" id="meta">Pick options and hit Generate.</div>
        <div class="row" id="tags"></div>
        <div class="warn" id="warn"></div>
      </div>
    </div>
  </div>

<script>
/* ------------------ Country tags (you can expand forever) ------------------ */
const TAGS = [
  ["GER","Germany"], ["USA","United States"], ["SOV","Soviet Union"], ["ENG","United Kingdom"],
  ["FRA","France"], ["ITA","Italy"], ["JAP","Japan"], ["CHI","China"], ["MAN","Manchukuo"],
  ["SWE","Sweden"], ["NOR","Norway"], ["DEN","Denmark"], ["FIN","Finland"], ["ICE","Iceland"],
  ["SPR","Spain"], ["POR","Portugal"], ["HOL","Netherlands"], ["BEL","Belgium"], ["LUX","Luxembourg"],
  ["AUS","Austria"], ["HUN","Hungary"], ["CZE","Czechoslovakia"], ["POL","Poland"], ["ROM","Romania"],
  ["YUG","Yugoslavia"], ["BUL","Bulgaria"], ["GRE","Greece"], ["ALB","Albania"], ["TUR","Turkey"],
  ["SWI","Switzerland"], ["EST","Estonia"], ["LAT","Latvia"], ["LIT","Lithuania"], ["IRE","Ireland"],
  ["EGY","Egypt"], ["IRQ","Iraq"], ["IRN","Iran"], ["SAU","Saudi Arabia"], ["YEM","Yemen"],
  ["SYR","Syria"], ["JOR","Jordan"], ["ISR","Israel"],
  ["LBA","Libya"], ["TUN","Tunisia"], ["ALG","Algeria"], ["MOR","Morocco"],
  ["SAF","South Africa"], ["ETH","Ethiopia"],
  ["CAN","Canada"], ["MEX","Mexico"], ["BRA","Brazil"], ["ARG","Argentina"], ["CHL","Chile"],
  ["COL","Colombia"], ["PER","Peru"], ["VEN","Venezuela"], ["BOL","Bolivia"], ["PAR","Paraguay"], ["URU","Uruguay"],
  ["RAJ","British Raj"], ["AST","Australia"], ["NZL","New Zealand"],
  ["SIA","Siam/Thailand"], ["PHI","Philippines"], ["INS","Indonesia"], ["MAL","Malaya"],
  ["VIE","Vietnam"], ["CAM","Cambodia"], ["LAO","Laos"],
  ["KOR","Korea"], ["MON","Mongolia"], ["TAN","Tannu Tuva"], ["AFG","Afghanistan"], ["NEP","Nepal"], ["BHU","Bhutan"]
];

/* ------------------ Catalog (all the common HOI4 nameables) ------------------ */
const CATALOG = [
  { key:"tank", label:"Tank", sub:[
    ["lt","Light Tank"], ["mt","Medium Tank"], ["ht","Heavy Tank"], ["sht","Super-Heavy Tank"],
    ["mbt","Main Battle Tank"], ["td","Tank Destroyer"], ["spg","Self-Propelled Gun"], ["spaa","Self-Propelled AA"]
  ]},
  { key:"plane", label:"Aircraft", sub:[
    ["fighter","Fighter"], ["heavy_fighter","Heavy Fighter"], ["cas","CAS"], ["nav","Naval Bomber"],
    ["tac","Tactical Bomber"], ["strat","Strategic Bomber"], ["recon","Recon"],
    ["jet_fighter","Jet Fighter"], ["jet_bomber","Jet Bomber"]
  ]},
  { key:"ship", label:"Ship (Surface)", sub:[
    ["dd","Destroyer"], ["cl","Light Cruiser"], ["ca","Heavy Cruiser"],
    ["bc","Battlecruiser"], ["bb","Battleship"], ["cv","Carrier"]
  ]},
  { key:"sub", label:"Submarine", sub:[
    ["ss","Submarine"], ["ss_long","Long-Range Submarine"], ["ss_modern","Modern Submarine"]
  ]},
  { key:"ground", label:"Ground Equipment (Flavor)", sub:[
    ["rifle","Infantry Equipment"], ["ar","Support Weapon"], ["at","Anti-Tank"], ["aa","Anti-Air"],
    ["arty","Artillery"], ["truck","Truck"], ["mech","Mechanized"], ["train","Train"]
  ]},
  { key:"naval_eq", label:"Naval Equipment (Flavor)", sub:[
    ["torp","Torpedo"], ["depth","Depth Charge"], ["mine","Naval Mine"], ["radar","Radar Set"]
  ]},
];

const elCategory = document.getElementById("category");
const elSubtype  = document.getElementById("subtype");
elCategory.innerHTML = CATALOG.map(c => `<option value="${c.key}">${c.label}</option>`).join("");
function fillSubtypes(){
  const cat = CATALOG.find(c => c.key === elCategory.value) || CATALOG[0];
  elSubtype.innerHTML = cat.sub.map(([k,l]) => `<option value="${k}">${l}</option>`).join("");
}
fillSubtypes();
elCategory.addEventListener("change", () => { fillSubtypes(); render(); });

/* ------------------ Helpers ------------------ */
const pick = (arr) => arr[Math.floor(Math.random() * arr.length)];
const randInt = (min, max) => Math.floor(Math.random()*(max-min+1))+min;
const letters = ["A","B","C","D","E","F","G","H","J","K"];
const roman = ["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"];

function clampYear(y){
  y = Number(y);
  if (!Number.isFinite(y)) return 1936;
  if (y < 1900) return 1900;
  if (y > 2100) return 2100;
  return Math.trunc(y);
}
function eraFor(y){
  if (y <= 1935) return "interwar";
  if (y <= 1945) return "ww2";
  if (y <= 1960) return "early_coldwar";
  return "late";
}
function styleFor(tag){
  tag = (tag||"").toUpperCase().trim();
  if (["USA","ENG","CAN","AST","NZL","SAF","IRE"].includes(tag)) return "EN";
  if (["GER","AUS"].includes(tag)) return "DE";
  if (["SOV","POL","CZE","HUN","ROM","BUL","YUG","GRE","LAT","LIT","EST","UKR","BLR"].includes(tag)) return "SL";
  if (["JAP"].includes(tag)) return "JP";
  if (["ITA"].includes(tag)) return "IT";
  if (["FRA","BEL","LUX"].includes(tag)) return "FR";
  return "GEN";
}
function tagToLabel(tag){
  tag = (tag||"").toUpperCase().trim();
  const found = TAGS.find(([t]) => t === tag);
  return found ? found[1] : tag;
}

/* ------------------ Searchable dropdown (real) ------------------ */
const elSearch = document.getElementById("countrySearch");
const elDrop = document.getElementById("dropdown");
const elSelTag = document.getElementById("selTag");
const elSelName = document.getElementById("selName");

let selectedTag = "GER";

function openDrop(){ elDrop.classList.add("open"); }
function closeDrop(){ elDrop.classList.remove("open"); }

function renderDrop(q){
  const query = (q||"").trim().toUpperCase();
  const results = TAGS
    .filter(([t,n]) => !query || t.includes(query) || n.toUpperCase().includes(query))
    .slice(0, 80);

  elDrop.innerHTML = results.map(([t,n]) => `
    <div class="item" data-tag="${t}" data-name="${n}">
      <div>
        <div class="tag">${t}</div>
        <div class="country">${n}</div>
      </div>
      <div class="small">Select</div>
    </div>
  `).join("") || `<div class="item"><div>No matches. Type a custom tag and use Generate.</div></div>`;
}

elSearch.addEventListener("focus", () => { renderDrop(elSearch.value); openDrop(); });
elSearch.addEventListener("input", () => { renderDrop(elSearch.value); openDrop(); });

elDrop.addEventListener("click", (e) => {
  const item = e.target.closest(".item");
  if (!item || !item.dataset.tag) return;
  selectedTag = item.dataset.tag;
  elSelTag.textContent = selectedTag;
  elSelName.textContent = `(${item.dataset.name})`;
  elSearch.value = selectedTag;
  closeDrop();
  render();
});

// close dropdown when clicking outside
document.addEventListener("click", (e) => {
  const picker = document.querySelector(".picker");
  if (!picker.contains(e.target)) closeDrop();
});

/* ------------------ UNIQUE naming (no historical model names) ------------------ */
/*
  Goal:
  - Strict: country-accurate designation FORMAT but randomized so it doesn't match real equipment.
  - Flavor: strict designation + a codename layer (still country-coded).
*/

function strictDesignation(tag, year, category, subtype){
  const y = clampYear(year);
  const era = eraFor(y);
  const style = styleFor(tag);

  // era-weighted ranges to keep things plausible-ish without matching real lines
  const tankN = (era==="interwar") ? randInt(1, 40) : (era==="ww2") ? randInt(41, 180) : (era==="early_coldwar") ? randInt(80, 220) : randInt(120, 360);
  const airN  = (era==="interwar") ? randInt(1, 50) : (era==="ww2") ? randInt(50, 450) : (era==="early_coldwar") ? randInt(80, 600) : randInt(120, 900);
  const shipN = randInt(1, 60);

  // Tanks
  if (category === "tank"){
    if (style === "DE") return `Pz.Kpfw. ${roman[randInt(0,7)]} Ausf. ${pick(letters)}-${tankN}`;
    if (style === "SL") return `T-${tankN}${pick(["","A","B","M"])}`;
    if (style === "JP") return `Type ${randInt(70, 120)} ${pick(["Ko","Otsu","Hei","Tei"])}-${tankN}`;
    if (style === "IT") return `Carro M${randInt(10, 40)}/${String(y).slice(2)}-${tankN}`;
    if (style === "FR") return `Char ${pick(["S","B","D","R"])}-${tankN} Mod. ${String(y).slice(2)}`;
    if (style === "EN"){
      // US/UK style without real names
      if (tag === "USA" || tag === "CAN") return `M${tankN}${pick(["","A1","A2","E1"])} (${subtype.toUpperCase()})`;
      return `A${tankN} Mk. ${pick(roman)} (${subtype.toUpperCase()})`;
    }
    return `${tag}-${subtype.toUpperCase()}-${tankN} (${y})`;
  }

  // Planes
  if (category === "plane"){
    if (style === "DE") return `${pick(["Bf","Fw","Ju","He","Do"])} ${airN}${pick(["","A","B","C"])}-${pick(letters)}`;
    if (style === "SL") return `${pick(["Yak","La","MiG","Il","Tu"])}-${airN}${pick(["","A","B","M"])}`;
    if (style === "JP") return `${pick(["Ki","A","D","B"])}-${airN} ${pick(["Model","Kai"])}-${randInt(1,9)}`;
    if (style === "IT") return `${pick(["MC","G","SM"])}.${airN}${pick(["","bis","ter"])}`;
    if (style === "FR") return `${pick(["D","MB","LeO","Potez"])}-${airN} ${pick(["Série","Mod."])} ${String(y).slice(2)}`;
    if (style === "EN"){
      if (tag === "USA" || tag === "CAN") return `${pick(["P","F","B","A"])}-${airN}${pick(["","A","B"])} (${subtype.toUpperCase()})`;
      return `${pick(["F","B","A","T"])}.${airN} Mk.${randInt(1,12)} (${subtype.toUpperCase()})`;
    }
    return `${tag}-${subtype.toUpperCase()}-${airN} (${y})`;
  }

  // Ships
  if (category === "ship"){
    if (style === "DE") return `${pick(["Z","K","S","T"])}-${shipN}${pick(["A","B","C"])} (${subtype.toUpperCase()})`;
    if (style === "SL") return `Project ${randInt(10, 120)}-${shipN} (${subtype.toUpperCase()})`;
    if (style === "JP") return `${pick(["No.","Model"])} ${shipN}-${randInt(1,9)} (${subtype.toUpperCase()})`;
    if (style === "EN") return `${pick(["Class","Group"])} ${pick(letters)}-${shipN} (${subtype.toUpperCase()})`;
    if (style === "IT") return `Classe ${pick(letters)}-${shipN} (${subtype.toUpperCase()})`;
    if (style === "FR") return `Classe ${pick(letters)}-${shipN} (${subtype.toUpperCase()})`;
    return `${tag}-${subtype.toUpperCase()}-H${shipN} (${y})`;
  }

  // Subs
  if (category === "sub"){
    const ssN = randInt(1, 900);
    if (style === "DE") return `U-${ssN} Typ ${pick(roman)}-${pick(letters)}`;
    if (style === "SL") return `Project ${randInt(200, 900)}-${ssN}`;
    if (style === "JP") return `I-${ssN} Model-${randInt(1,9)}`;
    if (style === "EN") return `${pick(letters)}-Class SS-${ssN}`;
    return `${tag}-SS-${ssN} (${y})`;
  }

  // Flavor categories (ground/naval_eq) still get strict-like codes
  return `${tag}-${subtype.toUpperCase()}-${randInt(100, 9999)} (${y})`;
}

function codenameFor(tag){
  const style = styleFor(tag);
  const en = ["Vanguard","Sentinel","Bulldog","Raven","Ironclad","Torch","Hawkeye","Trident","Aegis","Thunder"];
  const de = ["Sturm","Donner","Eisen","Blitz","Adler","Seewolf","Nebel","Wacht","Kobalt","Klinge"];
  const sl = ["Grom","Sokol","Zarya","Buran","Vityaz","Rusalka","Klin","Bastion","Volna","Medved"];
  const jp = ["Kaze","Tora","Ryu","Kumo","Haya","Sakura","Kitsune","Kurogane","Shiden","Raiden"];
  const it = ["Fulmine","Aquila","Leone","Folgore","Tempesta","Lupo","Vespro","Ardito","Bruno","Vento"];
  const fr = ["Foudre","Aigle","Vaillant","Renard","Lynx","Orage","Vigilant","Fer","Gloire","Sable"];
  const gen = ["Atlas","Nova","Specter","Bastion","Viper","Orion","Apex","Cobalt","Warden","Tempest"];
  if (style==="DE") return pick(de);
  if (style==="SL") return pick(sl);
  if (style==="JP") return pick(jp);
  if (style==="IT") return pick(it);
  if (style==="FR") return pick(fr);
  if (style==="EN") return pick(en);
  return pick(gen);
}

function flavorName(tag, year, category, subtype){
  const base = strictDesignation(tag, year, category, subtype);
  const code = codenameFor(tag);
  const tail = pick(["I","II","III","IV","V","VI","VII","VIII","IX","X"]);
  return `${base} “${code}-${tail}”`;
}

/* ------------------ Generate + UI ------------------ */
function generate(tag, year, category, subtype, mode){
  const t = (tag||"").toUpperCase().trim() || "UNK";
  const y = clampYear(year);
  const era = eraFor(y);

  const name = (mode === "strict")
    ? strictDesignation(t, y, category, subtype)
    : flavorName(t, y, category, subtype);

  return {
    name,
    meta: `${tagToLabel(t)} • ${category.toUpperCase()} • ${subtype.toUpperCase()} • Year ${y} • ${mode.toUpperCase()} • ${era.replaceAll("_"," ").toUpperCase()}`,
    pills: [`Tag: ${t}`, `Mode: ${mode}`, `Era: ${era.replaceAll("_"," ")}`]
  };
}

const elYear = document.getElementById("year");
const elMode = document.getElementById("mode");
const elName = document.getElementById("name");
const elMeta = document.getElementById("meta");
const elTags = document.getElementById("tags");
const elWarn = document.getElementById("warn");

function getEffectiveTag(){
  // If they typed a tag, use it. Otherwise use the selectedTag.
  const typed = (elSearch.value || "").toUpperCase().trim();
  if (typed.length >= 3) return typed.slice(0,3);
  return selectedTag;
}

function render(){
  const tag = getEffectiveTag();
  const year = elYear.value;
  const category = elCategory.value;
  const subtype = elSubtype.value;
  const mode = elMode.value;

  elSelTag.textContent = tag;
  elSelName.textContent = `(${tagToLabel(tag)})`;

  const out = generate(tag, year, category, subtype, mode);
  elName.textContent = out.name;
  elMeta.textContent = out.meta;

  elTags.innerHTML = "";
  out.pills.forEach(t => {
    const d = document.createElement("div");
    d.className = "pill";
    d.textContent = t;
    elTags.appendChild(d);
  });

  const inList = TAGS.some(([t]) => t === tag);
  elWarn.textContent = inList ? "" : "Tag not in built-in list (fine for mods/custom tags). Naming will use generic or style fallback.";
}

document.getElementById("gen").addEventListener("click", render);
document.getElementById("reroll").addEventListener("click", render);
[elYear, elMode, elSubtype].forEach(el => el.addEventListener("change", render));
elSubtype.addEventListener("change", render);

document.getElementById("copy").addEventListener("click", async () => {
  const text = elName.textContent;
  try {
    await navigator.clipboard.writeText(text);
    elWarn.textContent = "Copied to clipboard.";
    setTimeout(() => { elWarn.textContent = ""; }, 1200);
  } catch {
    elWarn.textContent = "Clipboard blocked by browser. Select and copy manually.";
  }
});

// initial state
elSearch.value = selectedTag;
renderDrop("");
render();
</script>
</body>
</html>
